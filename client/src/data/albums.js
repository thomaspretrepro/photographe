export const albumsData = [
  {
    "id": "portraits-claire-cerceaux",
    "title": "Claire, ballet du cercle et de l'eau",
    "description": "La danse du corps et du cercle, suspendue entre eau et lumière.",
    "category": "portrait",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756200568/_MG_5517_1_nc7iy7.jpg",
    "photoCount": 8,
    "sortOrder": 1,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756200568/_MG_5517_1_nc7iy7.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756207920/_MG_5526_1_dsoiy1.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756200568/_MG_5517_1_nc7iy7.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756207919/_MG_5590_1_eentrq.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756207919/_MG_5620_cm7tm3.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756207919/_MG_5617_1_srh4uf.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756207919/_MG_5517_1_zsedrf.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756208507/_MG_5620-2_nfdchj.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      }
    ]
  },
  {
    "id": "portraits-clara",
    "title": "Clara, rêverie au jardin du château",
    "description": "Sous les pierres anciennes, la lumière caresse la douceur d'un instant suspendu.",
    "category": "portrait",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288469/_MG_4694_suin7j.jpg",
    "photoCount": 9,
    "sortOrder": 2,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288469/_MG_4694_suin7j.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288472/_MG_4716_uxutjq.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288472/_MG_4834_m6ihx7.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288472/_MG_4701_cisdml.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288468/_MG_4616_wuxp9w.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288468/_MG_4599-2_uapyo4.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288474/_MG_4880_xjyahh.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288472/_MG_4803_kz1yv7.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      },
      {
        "id": 9,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288474/_MG_4890-4_kkavwf.jpg",
        "title": "",
        "description": "",
        "sortOrder": 9
      }
    ]
  },
  {
    "id": "portraits-claire-chantilly",
    "title": "Claire, Hiver au jardin",
    "description": "Une série de portraits capturant l'élégance et la personnalité unique de chaque sujet.",
    "category": "portrait",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288508/_MG_4433-2_ujg7we.jpg",
    "photoCount": 4,
    "sortOrder": 3,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288508/_MG_4433-2_ujg7we.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288509/_MG_4458_enryir.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756305415/_MG_4384-5_obwqzy.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288508/_MG_4380_oua1iq.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288508/_MG_4435_lrniz9.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288509/_MG_4447-Enhanced-NR_pdhdsk.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756305738/_MG_4476_n7h4xx.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756305739/_MG_4478_aij41e.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      },
      {
        "id": 9,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288512/_MG_4483-2_yowxqw.jpg",
        "title": "",
        "description": "",
        "sortOrder": 9
      }
    ]
  },
  {
    "id": "concert-Ankor",
    "title": "Ankor au Petit Bain",
    "description": "Concert d'Ankor au Petit Bain le 19 février 2025",
    "category": "concerts",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289062/_MG_3568_zpml2f.jpg",
    "photoCount": 18,
    "sortOrder": 4,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289059/_MG_3380_zeglvq.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289032/_MG_2661_gu8rax.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289031/_MG_2599_kb3cp8.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289022/_MG_2372_nlxri4.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289048/_MG_2920_sz7srh.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289067/_MG_4150_ixf2cd.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289042/_MG_2719_npxeiu.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289062/_MG_3568_zpml2f.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      },
      {
        "id": 90,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289047/_MG_2743_bibsjt.jpg",
        "title": "",
        "description": "",
        "sortOrder": 9
      },
      {
        "id": 10,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289027/_MG_2507-Enhanced-NR-2_faldyq.jpg",
        "title": "",
        "description": "",
        "sortOrder": 10
      },
      {
        "id": 11,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289051/_MG_2986_mnyzld.jpg",
        "title": "",
        "description": "",
        "sortOrder": 11
      },
      {
        "id": 12,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289067/_MG_4150_ixf2cd.jpg",
        "title": "",
        "description": "",
        "sortOrder": 12
      },
      {
        "id": 13,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289060/_MG_3440_nx9tvp.jpg",
        "title": "",
        "description": "",
        "sortOrder": 13
      },
      {
        "id": 14,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289047/_MG_2769_q6vaxt.jpg",
        "title": "",
        "description": "",
        "sortOrder": 14
      },
      {
        "id": 15,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289066/_MG_3820_fjnvhm.jpg",
        "title": "",
        "description": "",
        "sortOrder": 15
      },
      {
        "id": 16,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289062/_MG_3579_rhjjoh.jpg",
        "title": "",
        "description": "",
        "sortOrder": 16
      },
      {
        "id": 17,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289036/_MG_2685_e4qnak.jpg",
        "title": "",
        "description": "",
        "sortOrder": 17
      },
      {
        "id": 18,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289015/_MG_2084_y6nkjp.jpg",
        "title": "",
        "description": "",
        "sortOrder": 18
      }
    ]
  },
  {
    "id": "etratat",
    "title": "Weekend à Etretat",
    "description": "Exploration de la beauté naturelle à travers des paysages époustouflants.",
    "category": "landscape",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756308038/_MG_0511-min_mw7dnn.jpg",
    "photoCount": 9,
    "sortOrder": 5,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756308038/_MG_0511-min_mw7dnn.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288357/_MG_0587_aurtio.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288358/_MG_0639-2_z2q4rx.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288357/_MG_0204_qwblpl.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288357/_MG_0313_zuf3h1.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288356/_MG_0143_kksftp.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288356/_MG_0125_yluyhl.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288357/_MG_0221_bxzlou.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      },
      {
        "id": 9,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288356/_MG_0534_lipu1z.jpg",
        "title": "",
        "description": "",
        "sortOrder": 9
      }
    ]
  },
  {
    "id": "jade-HoH",
    "title": "Jades Hells on Heels",
    "description": "Jades en concert au Hell on Heels le 02 fervrier 2025",
    "category": "concerts",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288999/_MG_9606_dtvzk7.jpg",
    "photoCount": 9,
    "sortOrder": 6,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288999/_MG_9606_dtvzk7.jpg",
        "title": "",
        "description": "",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289001/_MG_9635_fz13la.jpg",
        "title": "",
        "description": "",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289006/_MG_9848_cz6hs2.jpg",
        "title": "",
        "description": "",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289011/_MG_9918_kqkmk2.jpg",
        "title": "",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289003/_MG_9735_pdf4ji.jpg",
        "title": "",
        "description": "",
        "sortOrder": 5
      },
      {
        "id": 6,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288994/_MG_9535_ikn0cr.jpg",
        "title": "",
        "description": "",
        "sortOrder": 6
      },
      {
        "id": 7,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288998/_MG_9576_j10nk0.jpg",
        "title": "",
        "description": "",
        "sortOrder": 7
      },
      {
        "id": 8,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756289005/_MG_9795_ok3gtm.jpg",
        "title": "",
        "description": "",
        "sortOrder": 8
      },
      {
        "id": 9,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288989/_MG_9363_dakq6a.jpg",
        "title": "",
        "description": "",
        "sortOrder": 9
      }
    ]
  },
  {
    "id": "essais-devoirs",
    "title": "Devoir photos",
    "description": "Photo faites dans le cadre d'une formation photo",
    "category": "essais",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288586/IMG_3656_g2glww.jpg",
    "photoCount": 5,
    "sortOrder": 7,
    "photos": [
      {
        "id": 1,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288586/IMG_3656_g2glww.jpg",
        "title": "Nature Morte",
        "description": "Exercice sur le style de Paulette Tavormina",
        "sortOrder": 1
      },
      {
        "id": 2,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288569/_MG_7717_a1q5wv.jpg",
        "title": "Packshot Montre",
        "description": "Packshot publicitaire de montre",
        "sortOrder": 2
      },
      {
        "id": 3,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288549/_MG_4284_b0idno.jpg",
        "title": "Mine de sucre - Monde miniature",
        "description": "Monde miniature en macro",
        "sortOrder": 3
      },
      {
        "id": 4,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288533/2-3-3_yzckat.jpg",
        "title": "Photo culinaire",
        "description": "",
        "sortOrder": 4
      },
      {
        "id": 5,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288631/IMG_3989_fz2stq.jpg",
        "title": "Land Art",
        "description": "",
        "sortOrder": 5
      }
    ]
  },
  {
    "id": "test",
    "title": "test",
    "description": "test",
    "category": "test",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756480212/_MG_0031_sjvkfw.jpg",
    "sortOrder": 0,
    "photoCount": 2,
    "photos": [
      {
        "id": 1756996426583,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756480212/_MG_0031_sjvkfw.jpg",
        "title": "",
        "description": "",
        "sortOrder": 0
      },
      {
        "id": 1756996426584,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756480391/IMG_9966-4_kfalsz.jpg",
        "title": "",
        "description": "",
        "sortOrder": 0
      }
    ]
  },
  {
    "id": "test-2",
    "title": "Test 2",
    "description": "Ceci est un album test",
    "category": "portrait",
    "coverImage": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288730/_MG_0468_xdney4.jpg",
    "sortOrder": 0,
    "photoCount": 1,
    "photos": [
      {
        "id": 1758888818842,
        "src": "https://res.cloudinary.com/dgcpwz1u4/image/upload/v1756288728/_MG_0407_ybfffr.jpg",
        "title": "un faucon",
        "description": "description optionnelle",
        "sortOrder": 0
      }
    ]
  }
];

// Helper function to get album by ID
export const getAlbumById = (id) => {
  const savedAlbums = localStorage.getItem('albumsData');
  let albums;
  
  if (savedAlbums) {
    albums = JSON.parse(savedAlbums);
  } else {
    // Initialize with full data including photos
    albums = albumsData;
    localStorage.setItem('albumsData', JSON.stringify(albums));
  }
  
  return albums.find(album => album.id === id);
};

// Helper function to get albums for gallery (without photos data)
export const getGalleryAlbums = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  let albums;
  
  if (savedAlbums) {
    albums = JSON.parse(savedAlbums);
  } else {
    // Initialize with full data including photos
    albums = albumsData;
    localStorage.setItem('albumsData', JSON.stringify(albums));
  }
  
  // Sort albums by sortOrder
  return albums
    .map(({ photos, ...album }) => album)
    .sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));
};

// Helper function to get full albums data (with photos)
export const getFullAlbumsData = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  
  if (savedAlbums) {
    const albums = JSON.parse(savedAlbums);
    // Sort albums by sortOrder and photos within each album
    return albums
      .sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0))
      .map(album => ({
        ...album,
        photos: (album.photos || []).sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0))
      }));
  } else {
    // Initialize with full data including photos
    localStorage.setItem('albumsData', JSON.stringify(albumsData));
    return albumsData;
  }
};

// Helper function to initialize localStorage with default data
export const initializeAlbumsData = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  if (!savedAlbums) {
    localStorage.setItem('albumsData', JSON.stringify(albumsData));
  }
};

// Helper function to save albums data to localStorage
export const saveAlbumsData = (albums) => {
  localStorage.setItem('albumsData', JSON.stringify(albums));
};

// Helper function to export localStorage data to albums.js format
export const exportToAlbumsJS = () => {
  const savedAlbums = JSON.parse(localStorage.getItem('albumsData') || '[]');
  return generateCompleteAlbumsJS(savedAlbums);
};

// Helper function to download the exported albums.js file
export const downloadAlbumsJS = () => {
  const content = exportToAlbumsJS();
  const blob = new Blob([content], { type: 'text/javascript' });
  const url = URL.createObjectURL(blob);
  
  const link = document.createElement('a');
  link.href = url;
  link.download = 'albums.js';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  URL.revokeObjectURL(url);
};

// Helper function to get GitHub configuration from localStorage
export const getGitHubConfig = () => {
  const config = localStorage.getItem('githubConfig');
  return config ? JSON.parse(config) : null;
};

// Helper function to save GitHub configuration to localStorage
export const saveGitHubConfig = (owner, repo, token, branch = 'main') => {
  const config = { owner, repo, token, branch };
  localStorage.setItem('githubConfig', JSON.stringify(config));
  return config;
};

// Helper function to check if GitHub configuration is complete
export const isConfigurationComplete = () => {
  const config = getGitHubConfig();
  return config && config.owner && config.repo && config.token && config.token.length > 10;
};

// Helper function to generate complete albums.js file content
const generateCompleteAlbumsJS = (albums) => {
  const albumsString = JSON.stringify(albums, null, 2);
  
  return `// Shared albums data
export const albumsData = ${albumsString};

// Helper function to get album by ID
export const getAlbumById = (id) => {
  const savedAlbums = localStorage.getItem('albumsData');
  let albums;
  
  if (savedAlbums) {
    albums = JSON.parse(savedAlbums);
  } else {
    // Initialize with full data including photos
    albums = albumsData;
    localStorage.setItem('albumsData', JSON.stringify(albums));
  }
  
  return albums.find(album => album.id === id);
};

// Helper function to get albums for gallery (without photos data)
export const getGalleryAlbums = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  let albums;
  
  if (savedAlbums) {
    albums = JSON.parse(savedAlbums);
  } else {
    // Initialize with full data including photos
    albums = albumsData;
    localStorage.setItem('albumsData', JSON.stringify(albums));
  }
  
  // Sort albums by sortOrder
  return albums
    .map(({ photos, ...album }) => album)
    .sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));
};

// Helper function to get full albums data (with photos)
export const getFullAlbumsData = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  
  if (savedAlbums) {
    const albums = JSON.parse(savedAlbums);
    // Sort albums by sortOrder and photos within each album
    return albums
      .sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0))
      .map(album => ({
        ...album,
        photos: (album.photos || []).sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0))
      }));
  } else {
    // Initialize with full data including photos
    localStorage.setItem('albumsData', JSON.stringify(albumsData));
    return albumsData;
  }
};

// Helper function to initialize localStorage with default data
export const initializeAlbumsData = () => {
  const savedAlbums = localStorage.getItem('albumsData');
  if (!savedAlbums) {
    localStorage.setItem('albumsData', JSON.stringify(albumsData));
  }
};

// Helper function to save albums data to localStorage
export const saveAlbumsData = (albums) => {
  localStorage.setItem('albumsData', JSON.stringify(albums));
};`;
};

// Helper function to publish albums to GitHub via repository dispatch
export const publishToGitHub = async (repoOwner, repoName, githubToken) => {
  try {
    const savedAlbums = JSON.parse(localStorage.getItem('albumsData') || '[]');
    const albumsJSContent = generateCompleteAlbumsJS(savedAlbums);
    
    // Trigger GitHub Actions workflow via repository dispatch
    const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/dispatches`, {
      method: 'POST',
      headers: {
        'Authorization': `token ${githubToken}`,
        'Accept': 'application/vnd.github.v3+json',
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        event_type: 'update-albums',
        client_payload: {
          albums_data: albumsJSContent,
          updated_by: 'Admin Interface',
          timestamp: new Date().toISOString(),
          albums_count: savedAlbums.length
        }
      }),
    });
    
    if (response.ok) {
      console.log('Albums published to GitHub successfully');
      return {
        success: true,
        message: 'Modifications publiées avec succès ! Le site sera mis à jour dans quelques minutes.'
      };
    } else {
      const errorData = await response.json();
      console.error('Failed to publish to GitHub:', errorData);
      return {
        success: false,
        message: `Erreur GitHub: ${errorData.message || 'Erreur inconnue'}`
      };
    }
  } catch (error) {
    console.error('Error publishing to GitHub:', error);
    return {
      success: false,
      message: 'Erreur de connexion à GitHub. Vérifiez votre token et votre connexion.'
    };
  }
};

// Helper function to save albums data to GitHub (main function)
export const saveAlbumsToGitHub = async () => {
  if (!isConfigurationComplete()) {
    return {
      success: false,
      message: 'Configuration GitHub incomplète. Veuillez configurer GitHub dans l\'interface admin.',
      requiresConfig: true
    };
  }
  
  const config = getGitHubConfig();
  return await publishToGitHub(config.owner, config.repo, config.token);
};
